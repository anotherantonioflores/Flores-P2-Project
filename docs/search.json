[
  {
    "objectID": "code/processing-code/processingfile-v1 - my version.html",
    "href": "code/processing-code/processingfile-v1 - my version.html",
    "title": "Preparing data for analysis",
    "section": "",
    "text": "Setup\nThe following packages are needed for this data processing\n\n\nData loading\n\ndata_location &lt;- here::here(\"data\",\"raw-data\",\"bank-full.csv\")\nrawdata &lt;- read.csv(data_location, header = TRUE, sep=\";\")\n\n\n\nCheck data\nExamining metadata by accessing the codebook. This codebook was taken directly from the data repository housing the chosen dataset. The decision was made to keep this in a separate xlsx file from the dataset so that the dataset could remain in the identical form in which it was sourced (CSV format).\n\ncodebook_location &lt;- \nhere::here(\"data\",\"raw-data\",\"codebook.xlsx\")\n\ncodebook &lt;- readxl::read_excel(codebook_location, sheet =\"Codebook\")\nprint(codebook)\n\n# A tibble: 17 × 4\n   `Variable Name` Type        Description                      `Missing Values`\n   &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;                            &lt;chr&gt;           \n 1 age             Integer     &lt;NA&gt;                             no              \n 2 job             Categorical type of job (categorical: 'admi… no              \n 3 marital         Categorical marital status (categorical: 'd… no              \n 4 education       Categorical (categorical: 'basic.4y','basic… no              \n 5 default         Binary      has credit in default?           no              \n 6 balance         Integer     average yearly balance in euros  no              \n 7 housing         Binary      has housing loan?                no              \n 8 loan            Binary      has personal loan?               no              \n 9 contact         Categorical contact communication type (cat… yes             \n10 day_of_week     Date        last contact day of the week     no              \n11 month           Date        last contact month of year (cat… no              \n12 duration        Integer     last contact duration, in secon… no              \n13 campaign        Integer     number of contacts performed du… no              \n14 pdays           Integer     number of days that passed by a… yes             \n15 previous        Integer     number of contacts performed be… no              \n16 poutcome        Categorical outcome of the previous marketi… yes             \n17 y               Binary      has the client subscribed a ter… no              \n\n\nVarious ways of looking at the data\n\ndplyr::glimpse(rawdata)\n\nRows: 45,211\nColumns: 17\n$ age       &lt;int&gt; 58, 44, 33, 47, 33, 35, 28, 42, 58, 43, 41, 29, 53, 58, 57, …\n$ job       &lt;chr&gt; \"management\", \"technician\", \"entrepreneur\", \"blue-collar\", \"…\n$ marital   &lt;chr&gt; \"married\", \"single\", \"married\", \"married\", \"single\", \"marrie…\n$ education &lt;chr&gt; \"tertiary\", \"secondary\", \"secondary\", \"unknown\", \"unknown\", …\n$ default   &lt;chr&gt; \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"yes\", \"no\", \"no\",…\n$ balance   &lt;int&gt; 2143, 29, 2, 1506, 1, 231, 447, 2, 121, 593, 270, 390, 6, 71…\n$ housing   &lt;chr&gt; \"yes\", \"yes\", \"yes\", \"yes\", \"no\", \"yes\", \"yes\", \"yes\", \"yes\"…\n$ loan      &lt;chr&gt; \"no\", \"no\", \"yes\", \"no\", \"no\", \"no\", \"yes\", \"no\", \"no\", \"no\"…\n$ contact   &lt;chr&gt; \"unknown\", \"unknown\", \"unknown\", \"unknown\", \"unknown\", \"unkn…\n$ day       &lt;int&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, …\n$ month     &lt;chr&gt; \"may\", \"may\", \"may\", \"may\", \"may\", \"may\", \"may\", \"may\", \"may…\n$ duration  &lt;int&gt; 261, 151, 76, 92, 198, 139, 217, 380, 50, 55, 222, 137, 517,…\n$ campaign  &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ pdays     &lt;int&gt; -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, …\n$ previous  &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ poutcome  &lt;chr&gt; \"unknown\", \"unknown\", \"unknown\", \"unknown\", \"unknown\", \"unkn…\n$ y         &lt;chr&gt; \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", …\n\nsummary(rawdata)\n\n      age            job              marital           education        \n Min.   :18.00   Length:45211       Length:45211       Length:45211      \n 1st Qu.:33.00   Class :character   Class :character   Class :character  \n Median :39.00   Mode  :character   Mode  :character   Mode  :character  \n Mean   :40.94                                                           \n 3rd Qu.:48.00                                                           \n Max.   :95.00                                                           \n   default             balance         housing              loan          \n Length:45211       Min.   : -8019   Length:45211       Length:45211      \n Class :character   1st Qu.:    72   Class :character   Class :character  \n Mode  :character   Median :   448   Mode  :character   Mode  :character  \n                    Mean   :  1362                                        \n                    3rd Qu.:  1428                                        \n                    Max.   :102127                                        \n   contact               day           month              duration     \n Length:45211       Min.   : 1.00   Length:45211       Min.   :   0.0  \n Class :character   1st Qu.: 8.00   Class :character   1st Qu.: 103.0  \n Mode  :character   Median :16.00   Mode  :character   Median : 180.0  \n                    Mean   :15.81                      Mean   : 258.2  \n                    3rd Qu.:21.00                      3rd Qu.: 319.0  \n                    Max.   :31.00                      Max.   :4918.0  \n    campaign          pdays          previous          poutcome        \n Min.   : 1.000   Min.   : -1.0   Min.   :  0.0000   Length:45211      \n 1st Qu.: 1.000   1st Qu.: -1.0   1st Qu.:  0.0000   Class :character  \n Median : 2.000   Median : -1.0   Median :  0.0000   Mode  :character  \n Mean   : 2.764   Mean   : 40.2   Mean   :  0.5803                     \n 3rd Qu.: 3.000   3rd Qu.: -1.0   3rd Qu.:  0.0000                     \n Max.   :63.000   Max.   :871.0   Max.   :275.0000                     \n      y            \n Length:45211      \n Class :character  \n Mode  :character  \n                   \n                   \n                   \n\nhead(rawdata)\n\n  age          job marital education default balance housing loan contact day\n1  58   management married  tertiary      no    2143     yes   no unknown   5\n2  44   technician  single secondary      no      29     yes   no unknown   5\n3  33 entrepreneur married secondary      no       2     yes  yes unknown   5\n4  47  blue-collar married   unknown      no    1506     yes   no unknown   5\n5  33      unknown  single   unknown      no       1      no   no unknown   5\n6  35   management married  tertiary      no     231     yes   no unknown   5\n  month duration campaign pdays previous poutcome  y\n1   may      261        1    -1        0  unknown no\n2   may      151        1    -1        0  unknown no\n3   may       76        1    -1        0  unknown no\n4   may       92        1    -1        0  unknown no\n5   may      198        1    -1        0  unknown no\n6   may      139        1    -1        0  unknown no\n\nskimr::skim(rawdata)\n\n\nData summary\n\n\nName\nrawdata\n\n\nNumber of rows\n45211\n\n\nNumber of columns\n17\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\ncharacter\n10\n\n\nnumeric\n7\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: character\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmin\nmax\nempty\nn_unique\nwhitespace\n\n\n\n\njob\n0\n1\n6\n13\n0\n12\n0\n\n\nmarital\n0\n1\n6\n8\n0\n3\n0\n\n\neducation\n0\n1\n7\n9\n0\n4\n0\n\n\ndefault\n0\n1\n2\n3\n0\n2\n0\n\n\nhousing\n0\n1\n2\n3\n0\n2\n0\n\n\nloan\n0\n1\n2\n3\n0\n2\n0\n\n\ncontact\n0\n1\n7\n9\n0\n3\n0\n\n\nmonth\n0\n1\n3\n3\n0\n12\n0\n\n\npoutcome\n0\n1\n5\n7\n0\n4\n0\n\n\ny\n0\n1\n2\n3\n0\n2\n0\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nage\n0\n1\n40.94\n10.62\n18\n33\n39\n48\n95\n▅▇▃▁▁\n\n\nbalance\n0\n1\n1362.27\n3044.77\n-8019\n72\n448\n1428\n102127\n▇▁▁▁▁\n\n\nday\n0\n1\n15.81\n8.32\n1\n8\n16\n21\n31\n▇▆▇▆▆\n\n\nduration\n0\n1\n258.16\n257.53\n0\n103\n180\n319\n4918\n▇▁▁▁▁\n\n\ncampaign\n0\n1\n2.76\n3.10\n1\n1\n2\n3\n63\n▇▁▁▁▁\n\n\npdays\n0\n1\n40.20\n100.13\n-1\n-1\n-1\n-1\n871\n▇▁▁▁▁\n\n\nprevious\n0\n1\n0.58\n2.30\n0\n0\n0\n0\n275\n▇▁▁▁▁\n\n\n\n\n\n\n\nCleaning the data\nWe are mainly converting character variables into factors so we can do some categorical analysis. I had initially included converting months to a numeric variable but realized that it was fine as a factor variable.\n\nd1 = rawdata |&gt; \n  mutate(job = as.factor(job)) |&gt;\n  mutate(marital = as.factor(marital)) |&gt;\n  mutate(education = as.factor(education)) |&gt;\n  mutate(default = as.factor(default)) |&gt;\n  mutate(housing = as.factor(housing)) |&gt;\n  mutate(loan = as.factor(loan)) |&gt;\n  mutate(education = as.factor(education)) |&gt;\n  mutate(contact = as.factor(contact)) |&gt;\n  mutate(month = as.factor(month)) |&gt;\n  mutate(poutcome = as.factor(poutcome)) |&gt;\n  mutate(day = as.factor(day)) |&gt;\n  mutate(y = ifelse(y == \"yes\", 1, 0))\n\n\ncolnames(d1)[17] &lt;- \"y_termSubscribed\"\n\n\nsummary(d1)\n\n      age                 job           marital          education    \n Min.   :18.00   blue-collar:9732   divorced: 5207   primary  : 6851  \n 1st Qu.:33.00   management :9458   married :27214   secondary:23202  \n Median :39.00   technician :7597   single  :12790   tertiary :13301  \n Mean   :40.94   admin.     :5171                    unknown  : 1857  \n 3rd Qu.:48.00   services   :4154                                     \n Max.   :95.00   retired    :2264                                     \n                 (Other)    :6835                                     \n default        balance       housing      loan            contact     \n no :44396   Min.   : -8019   no :20081   no :37967   cellular :29285  \n yes:  815   1st Qu.:    72   yes:25130   yes: 7244   telephone: 2906  \n             Median :   448                           unknown  :13020  \n             Mean   :  1362                                            \n             3rd Qu.:  1428                                            \n             Max.   :102127                                            \n                                                                       \n      day            month          duration         campaign     \n 20     : 2752   may    :13766   Min.   :   0.0   Min.   : 1.000  \n 18     : 2308   jul    : 6895   1st Qu.: 103.0   1st Qu.: 1.000  \n 21     : 2026   aug    : 6247   Median : 180.0   Median : 2.000  \n 17     : 1939   jun    : 5341   Mean   : 258.2   Mean   : 2.764  \n 6      : 1932   nov    : 3970   3rd Qu.: 319.0   3rd Qu.: 3.000  \n 5      : 1910   apr    : 2932   Max.   :4918.0   Max.   :63.000  \n (Other):32344   (Other): 6060                                    \n     pdays          previous           poutcome     y_termSubscribed\n Min.   : -1.0   Min.   :  0.0000   failure: 4901   Min.   :0.000   \n 1st Qu.: -1.0   1st Qu.:  0.0000   other  : 1840   1st Qu.:0.000   \n Median : -1.0   Median :  0.0000   success: 1511   Median :0.000   \n Mean   : 40.2   Mean   :  0.5803   unknown:36959   Mean   :0.117   \n 3rd Qu.: -1.0   3rd Qu.:  0.0000                   3rd Qu.:0.000   \n Max.   :871.0   Max.   :275.0000                   Max.   :1.000   \n                                                                    \n\n\nAll done, data is clean now.\nAssigning data to output variable.\n\nprocesseddata1 &lt;- d1\n\n\n\nSave data\n\nsave_data_location &lt;- here::here(\"data\",\"processed-data\",\"processeddata1.rds\")\nsaveRDS(processeddata1, file = save_data_location)"
  }
]